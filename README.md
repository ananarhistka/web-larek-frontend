# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Базовый код

## Об архитектуре 

Взаимодействия внутри приложения происходят через события. Модели инициализируют события, слушатели событий в основном коде выполняют передачу данных компонентам отображения, а также вычислениями между этой передачей, и еще они меняют значения в моделях.
м

## 1-Класс Api

Класс Api представляет собой базовый класс для работы с API сервера. Он содержит следующие поля, методы и сеттеры:

Поля:
```ts
1. baseUrl: string - используемый домен сервера.
2. options: RequestInit - параметры запроса.
```
Методы:
```ts
1. constructor(baseUrl: string, options: RequestInit = {}) - конструктор класса, принимает базовый URL сервера и параметры запроса.
2. handleResponse(response: Response) - обрабатывает ответ сервера и возвращает либо полученные данные JSON, либо сообщение об ошибке.
3. get(uri: string) - реализация метода GET для выполнения запроса на получение данных с сервера.
4. post(uri: string, data: object, method: ApiPostMethods = 'POST') - реализация метода POST для передачи данных на сервер.
```
Все методы выполняют запросы с использованием fetch API и обрабатывают ответы сервера. Класс Api обеспечивает возможность выполнения запросов GET и POST к API сервера, а также обработку ответов сервера для получения данных или сообщений об ошибках.

## 2-Component<T>

Класс Component<T> представляет собой абстрактный класс для создания компонентов с определенным типом данных T. В конструктор класса Component<T> приходят следующие данные:

1. container: HTMLElement - элемент DOM, в который будет встроен компонент.
2. events: IEvents - интерфейс, определяющий возможные события компонента.
```ts
Класс Component<T> выполняет следующие функции:

1. toggleClass(element: HTMLElement, className: string, force?: boolean) - переключение класса у элемента.
2. setText(element: HTMLElement, value: unknown) - установка текстового содержимого элемента.
3. setDisabled(element: HTMLElement, state: boolean) - изменение статуса блокировки элемента.
4. setHidden(element: HTMLElement) - скрытие элемента.
5. setVisible(element: HTMLElement) - отображение элемента.
6. setImage(element: HTMLElement, src: string, alt?: string) - установка изображения с альтернативным текстом.
7. render(data?: Partial<T>): HTMLElement - возвращает корневой DOM-элемент компонента, применяя частичные данные для рендеринга.
```
Поля, методы и сеттеры класса Component<T>:
```ts
Поля:
1. container (тип: HTMLElement) - элемент DOM, в который будет встроен компонент.
2. events (тип: IEvents) - интерфейс событий компонента.

Методы:
1. toggleClass(element: HTMLElement, className: string, force?: boolean) - переключает класс у элемента.
2. setText(element: HTMLElement, value: unknown) - устанавливает текстовое содержимое элемента.
3. setDisabled(element: HTMLElement, state: boolean) - изменяет статус блокировки элемента.
4. setHidden(element: HTMLElement) - скрывает элемент.
5. setVisible(element: HTMLElement) - отображает элемент.
6. setImage(element: HTMLElement, src: string, alt?: string) - устанавливает изображение с альтернативным текстом.
7. render(data?: Partial<T>): HTMLElement - возвращает корневой DOM-элемент компонента с применёнными данными.
```
Класс Component<T> служит для создания компонентов с определенным типом данных и предоставляет методы для работы с DOM-элементами и их состояниями.

## 3-EventEmitter

EventEmitter класс, который представляет собой реализацию брокера событий с возможностью подписки на события, отписки от событий и генерации событий.

Класс представляет собой методы для установки обработчика на событие (on), инициирования события с данными (emit), слушания всех событий (onAll), сброса всех обработчиков (offAll) и создания триггера для генерации события при вызове (trigger).

## 4-Model

Базовый класс Model представляет собой абстрактную модель, которая используется для хранения данных и уведомления об изменениях. Конструктор класса принимает частичные данные типа T и объект событий IEvents.

Метод emitChanges используется для сообщения об изменениях в модели.

## Компоненты модели данных (бизнес-логика)

## 1-MainPage

Класс MainPage предназначен для управления состоянием главной страницы приложения, отображения выбранных продуктов в корзине, просмотра продукта, отображения всех категорий и отслеживания продуктов в корзине.
```ts
Поля класса MainPage:
 Поля класса:
 directory: ICartItem - список всех карточек на странице
 cart: ICartItem - выбранные продукты в корзине
 preview: ICartItem - модальное окно карточки

Методы класса:
 getFullPrice(): number - метод для вычисления полной стоимости заказа на основе выбранных продуктов в корзине
```

## 2-Product

Класс Product описывает отдельный лот товара.

В классе Product определены следующие свойства:
```ts
 id: string; - идентификатор лота;
 name: string; - название лота;
 price: number; - цена лота;
 description: string; - описание лота;
 image: string; - изображение лота;
```
## 3-CartItem

Класс CartItem принимает следующие данные в конструкторе:
```ts
 id: string - идентификатор товара
 name: string - название товара
 price: number - цена товара
 description: string - описание товара
 image: string - ссылка на изображение товара
 sector: LotSection[] - сектор каждой карточки
 ```

Класс CartItem предназначен для представления товара в корзине. Он объединяет свойства товара из интерфейса IProduct и методы изменения количества товара в корзине из интерфейса ICartModel.

Поля класса:
```ts
 id: string
 name: string
 price: number
 description: string
 image: string
 sector: LotSection[]
 ```

Методы класса:
```ts
 add(id: string): void - метод для добавления товара в корзину по идентификатору
 remove(id: string): void - метод для удаления товара из корзины по идентификатору
 ```

Сеттеры класса:
Отсутствуют.

## 3-Order

Класс Order представляет заказ и содержит следующие данные в конструкторе и их типы:
```ts
1. address: DeliveryAddress - адрес доставки (тип: DeliveryAddress)
2. email: string - электронная почта для связи с клиентом (тип: string)
3. phone: string - номер телефона для связи с клиентом (тип: string)
4. list: ICartItem - массив товаров в заказе (тип: ICartItem)
5. checkingTheAddress(): void - метод для проверки адреса доставки
6. checkingThePhone(): void - метод для проверки номера телефона
7. checkingEmail(): void - метод для проверки электронной почты
8. completingTheOrder(): void - метод для завершения оформления заказа
```
Класс Order является интерфейсом для представления заказа. Он выполняет функции по хранению информации о заказе (адрес, контактные данные, список товаров), проверке введенных данных клиентом (адреса, телефона, электронной почты) и завершению оформления заказа. Также класс предоставляет возможность работы с интерфейсом IMakingAnOrder, который содержит информацию об адресе и контактных данных, необходимых для заказа.

## Компоненты представления

## 1-DeliveryAddress

DeliveryAddress:
Предоставляет информацию об адресе доставки и методе оплаты.
```ts
 Свойства:
  1.adress: string | number - адрес доставки (строка или число).
  2.payment: PaymentMethod - метод оплаты типа PaymentMethod. 
```
## 2-MakingAnOrder

MakingAnOrder:
Предоставляет информацию для выполнения заказа.
```ts
 Свойства:
  1.amail: string - адрес электронной почты заказчика.
  2.phone: string - номер телефона заказчика.
```
## Ключевые типы данных
```ts
//описание карточки 
interface IProduct {
   id: number;//id карточки
   name: string;//имя карточки
   price: number;//цена карточки 
   description: string;//описание 
   image: string;//путь к изображению
}

//интерфейс главной страницы
export interface MainPage {
  directory: CartItem[]; //список всех карточек на странице
  cart: CartItem[]; //выбранные продукты в корзине
  preview: CartItem; //модальное окно карточки
  getFullPrice: number;//получить поную стоймось заказа
}
```

```ts
//все события на сайте
enum Events {
      CATALOG_PRODUCTS = "product:changed", //все категории карточек
      HOVER_PRODUCTS = "product:hover",//навели на карточку
      CLICK_PRODUCTS = "card:open", //кликнули по карточке
      OPEN_MODAL = "modal:open", //при клике на карточку открывается модальное окно
      CLOSE_MODAL = "modal:close",//приклике на креситк закрывется модальное окно
      CHANGING_PRODUCT_CART = "cart:changed",//добавить продукт в корзину
      OPEN_CART = "cart:open",//открыти корзины
      MAKING_AN_ORDER = "making-order:open",//переход к оформлению заказа
      PAYMENT_METHOD = "payment:changed",//способ оплаты
      FILLING_IN_FIELDS_WHITH_DATE = "data-field:changed",//заполняем поля данными 
      ORDER_COMPLETION = "order-completion:post",//заказ оформлен
}
```